# A reusable step to initialize the version of the published RDMnetBroker artifacts.

steps:
  - pwsh: |
      $Env:BROKER_VERSION = (Get-Content .\tools\version\current_version.txt)
      if ([regex]::IsMatch($Env:BUILD_SOURCEBRANCH, "^(refs\/tags\/)")) {
        Write-Host "##vso[task.setvariable variable=broker_artifact_version]$Env:BROKER_VERSION"
      } else {
        Write-Host "##vso[task.setvariable variable=broker_artifact_version]$Env:BUILD_SOURCEVERSION"
      }
    displayName: 'Initialize Broker Artifact Version'
